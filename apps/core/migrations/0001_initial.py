# Generated by Django 5.2 on 2026-01-16 17:34

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('customers', '0001_initial'),
        ('products', '0001_initial'),
        ('purchasing', '0002_purchasereturn_purchasereturnitem_supplierprice_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='AccountPayable',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
                ('is_deleted', models.BooleanField(default=False, verbose_name='已刪除')),
                ('deleted_at', models.DateTimeField(blank=True, null=True, verbose_name='刪除時間')),
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('payable_number', models.CharField(max_length=30, unique=True, verbose_name='帳款編號')),
                ('total_amount', models.DecimalField(decimal_places=2, max_digits=15, verbose_name='總金額')),
                ('paid_amount', models.DecimalField(decimal_places=2, default=0, max_digits=15, verbose_name='已付金額')),
                ('invoice_date', models.DateField(verbose_name='發票日期')),
                ('due_date', models.DateField(verbose_name='到期日')),
                ('status', models.CharField(choices=[('PENDING', '待付款'), ('PARTIAL', '部分付款'), ('PAID', '已付款'), ('OVERDUE', '逾期')], default='PENDING', max_length=10, verbose_name='狀態')),
                ('invoice_number', models.CharField(blank=True, max_length=50, verbose_name='發票號碼')),
                ('notes', models.TextField(blank=True, verbose_name='備註')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='建立者')),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL, verbose_name='刪除者')),
                ('goods_receipt', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='payables', to='purchasing.goodsreceipt', verbose_name='收貨單')),
                ('purchase_order', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='payables', to='purchasing.purchaseorder', verbose_name='採購單')),
                ('supplier', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='payables', to='purchasing.supplier', verbose_name='供應商')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='更新者')),
            ],
            options={
                'verbose_name': '應付帳款',
                'verbose_name_plural': '應付帳款',
                'db_table': 'accounts_payable',
                'ordering': ['-due_date'],
            },
        ),
        migrations.CreateModel(
            name='AuditLog',
            fields=[
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('audit_id', models.CharField(max_length=64, unique=True, verbose_name='審計ID')),
                ('username', models.CharField(max_length=150, verbose_name='使用者名稱')),
                ('action', models.CharField(choices=[('CREATE', '新增'), ('UPDATE', '更新'), ('DELETE', '刪除'), ('CONFIRM', '確認'), ('VOID', '作廢'), ('APPROVE', '核准'), ('REJECT', '駁回'), ('LOCK', '鎖定'), ('UNLOCK', '解鎖'), ('EXPORT', '匯出'), ('LOGIN', '登入'), ('LOGOUT', '登出')], max_length=20, verbose_name='操作')),
                ('module', models.CharField(choices=[('AUTH', '認證'), ('USER', '使用者'), ('ROLE', '角色'), ('PRODUCT', '商品'), ('CATEGORY', '分類'), ('STORE', '門市'), ('WAREHOUSE', '倉庫'), ('CUSTOMER', '客戶'), ('ORDER', '訂單'), ('POS', 'POS'), ('INVENTORY', '庫存'), ('STOCK_COUNT', '盤點'), ('STOCK_TRANSFER', '轉撥'), ('SUPPLIER', '供應商'), ('PURCHASE_ORDER', '採購單'), ('REPORT', '報表'), ('UNKNOWN', '未知')], max_length=30, verbose_name='模組')),
                ('target_id', models.CharField(blank=True, max_length=64, null=True, verbose_name='目標ID')),
                ('target_type', models.CharField(blank=True, max_length=50, null=True, verbose_name='目標類型')),
                ('old_value', models.JSONField(blank=True, null=True, verbose_name='舊值')),
                ('new_value', models.JSONField(blank=True, null=True, verbose_name='新值')),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True, verbose_name='IP位址')),
                ('user_agent', models.CharField(blank=True, max_length=500, null=True, verbose_name='User Agent')),
                ('created_at', models.DateTimeField(verbose_name='操作時間')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='audit_logs', to=settings.AUTH_USER_MODEL, verbose_name='使用者')),
            ],
            options={
                'verbose_name': '審計日誌',
                'verbose_name_plural': '審計日誌',
                'db_table': 'audit_logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='NumberingRule',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
                ('is_deleted', models.BooleanField(default=False, verbose_name='已刪除')),
                ('deleted_at', models.DateTimeField(blank=True, null=True, verbose_name='刪除時間')),
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('document_type', models.CharField(choices=[('ORDER', '銷售訂單'), ('PURCHASE_ORDER', '採購單'), ('GOODS_RECEIPT', '收貨單'), ('STOCK_TRANSFER', '調撥單'), ('STOCK_COUNT', '盤點單'), ('MEMBER', '會員編號'), ('INVOICE', '發票'), ('REFUND', '退貨單')], max_length=30, unique=True, verbose_name='單據類型')),
                ('prefix', models.CharField(blank=True, default='', max_length=10, verbose_name='前綴')),
                ('suffix', models.CharField(blank=True, default='', max_length=10, verbose_name='後綴')),
                ('date_format', models.CharField(default='YYYYMMDD', max_length=20, verbose_name='日期格式')),
                ('sequence_length', models.IntegerField(default=4, verbose_name='流水號位數')),
                ('current_sequence', models.IntegerField(default=0, verbose_name='目前流水號')),
                ('last_reset_date', models.DateField(blank=True, null=True, verbose_name='上次重置日期')),
                ('reset_frequency', models.CharField(choices=[('NEVER', '不重置'), ('DAILY', '每日'), ('MONTHLY', '每月'), ('YEARLY', '每年')], default='DAILY', max_length=10, verbose_name='重置頻率')),
                ('is_active', models.BooleanField(default=True, verbose_name='啟用')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='建立者')),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL, verbose_name='刪除者')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='更新者')),
            ],
            options={
                'verbose_name': '編號規則',
                'verbose_name_plural': '編號規則',
                'db_table': 'numbering_rules',
            },
        ),
        migrations.CreateModel(
            name='PayablePayment',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
                ('is_deleted', models.BooleanField(default=False, verbose_name='已刪除')),
                ('deleted_at', models.DateTimeField(blank=True, null=True, verbose_name='刪除時間')),
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('amount', models.DecimalField(decimal_places=2, max_digits=15, verbose_name='付款金額')),
                ('payment_date', models.DateField(verbose_name='付款日期')),
                ('payment_method', models.CharField(default='BANK_TRANSFER', max_length=20, verbose_name='付款方式')),
                ('reference_number', models.CharField(blank=True, max_length=50, verbose_name='參考編號')),
                ('notes', models.TextField(blank=True, verbose_name='備註')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='建立者')),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL, verbose_name='刪除者')),
                ('payable', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='payments', to='core.accountpayable', verbose_name='應付帳款')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='更新者')),
            ],
            options={
                'verbose_name': '付款紀錄',
                'verbose_name_plural': '付款紀錄',
                'db_table': 'payable_payments',
                'ordering': ['-payment_date'],
            },
        ),
        migrations.CreateModel(
            name='PaymentMethod',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
                ('is_deleted', models.BooleanField(default=False, verbose_name='已刪除')),
                ('deleted_at', models.DateTimeField(blank=True, null=True, verbose_name='刪除時間')),
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('code', models.CharField(max_length=20, unique=True, verbose_name='付款方式代碼')),
                ('name', models.CharField(max_length=50, verbose_name='付款方式名稱')),
                ('description', models.TextField(blank=True, verbose_name='描述')),
                ('is_active', models.BooleanField(default=True, verbose_name='啟用')),
                ('sort_order', models.IntegerField(default=0, verbose_name='排序')),
                ('fee_rate', models.DecimalField(decimal_places=2, default=0, max_digits=5, verbose_name='手續費率 (%)')),
                ('requires_reference', models.BooleanField(default=False, verbose_name='需要參考編號')),
                ('icon', models.CharField(blank=True, max_length=50, verbose_name='圖示')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='建立者')),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL, verbose_name='刪除者')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='更新者')),
            ],
            options={
                'verbose_name': '付款方式',
                'verbose_name_plural': '付款方式',
                'db_table': 'payment_methods',
                'ordering': ['sort_order', 'name'],
            },
        ),
        migrations.CreateModel(
            name='ProductPrice',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
                ('is_deleted', models.BooleanField(default=False, verbose_name='已刪除')),
                ('deleted_at', models.DateTimeField(blank=True, null=True, verbose_name='刪除時間')),
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('price_type', models.CharField(choices=[('REGULAR', '一般售價'), ('MEMBER', '會員價'), ('VIP', 'VIP 價'), ('WHOLESALE', '批發價'), ('PROMOTIONAL', '促銷價')], default='REGULAR', max_length=20, verbose_name='價格類型')),
                ('price', models.DecimalField(decimal_places=2, max_digits=10, verbose_name='價格')),
                ('min_quantity', models.IntegerField(default=1, verbose_name='最小購買數量')),
                ('valid_from', models.DateTimeField(blank=True, null=True, verbose_name='生效日期')),
                ('valid_to', models.DateTimeField(blank=True, null=True, verbose_name='結束日期')),
                ('is_active', models.BooleanField(default=True, verbose_name='啟用')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='建立者')),
                ('customer_level', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='product_prices', to='customers.customerlevel', verbose_name='會員等級')),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL, verbose_name='刪除者')),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='prices', to='products.product', verbose_name='商品')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='更新者')),
            ],
            options={
                'verbose_name': '商品價格',
                'verbose_name_plural': '商品價格',
                'db_table': 'product_prices',
                'ordering': ['product', 'price_type', 'min_quantity'],
            },
        ),
        migrations.CreateModel(
            name='SupplierPerformance',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='建立時間')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='更新時間')),
                ('is_deleted', models.BooleanField(default=False, verbose_name='已刪除')),
                ('deleted_at', models.DateTimeField(blank=True, null=True, verbose_name='刪除時間')),
                ('id', models.BigAutoField(primary_key=True, serialize=False)),
                ('period_start', models.DateField(verbose_name='期間開始')),
                ('period_end', models.DateField(verbose_name='期間結束')),
                ('total_orders', models.IntegerField(default=0, verbose_name='總訂單數')),
                ('completed_orders', models.IntegerField(default=0, verbose_name='完成訂單數')),
                ('on_time_deliveries', models.IntegerField(default=0, verbose_name='準時交貨數')),
                ('quality_pass_orders', models.IntegerField(default=0, verbose_name='品質合格數')),
                ('total_amount', models.DecimalField(decimal_places=2, default=0, max_digits=15, verbose_name='總採購金額')),
                ('return_amount', models.DecimalField(decimal_places=2, default=0, max_digits=15, verbose_name='退貨金額')),
                ('delivery_score', models.DecimalField(decimal_places=2, default=0, max_digits=5, verbose_name='交期得分')),
                ('quality_score', models.DecimalField(decimal_places=2, default=0, max_digits=5, verbose_name='品質得分')),
                ('price_score', models.DecimalField(decimal_places=2, default=0, max_digits=5, verbose_name='價格得分')),
                ('service_score', models.DecimalField(decimal_places=2, default=0, max_digits=5, verbose_name='服務得分')),
                ('overall_score', models.DecimalField(decimal_places=2, default=0, max_digits=5, verbose_name='綜合得分')),
                ('rating', models.CharField(choices=[('A', '優良'), ('B', '良好'), ('C', '普通'), ('D', '待改善'), ('F', '不合格')], default='C', max_length=1, verbose_name='評等')),
                ('notes', models.TextField(blank=True, verbose_name='備註')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='建立者')),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL, verbose_name='刪除者')),
                ('supplier', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='performances', to='purchasing.supplier', verbose_name='供應商')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='更新者')),
            ],
            options={
                'verbose_name': '供應商績效',
                'verbose_name_plural': '供應商績效',
                'db_table': 'supplier_performances',
                'ordering': ['-period_end'],
            },
        ),
        migrations.AddIndex(
            model_name='accountpayable',
            index=models.Index(fields=['supplier'], name='accounts_pa_supplie_774218_idx'),
        ),
        migrations.AddIndex(
            model_name='accountpayable',
            index=models.Index(fields=['status'], name='accounts_pa_status_581e6c_idx'),
        ),
        migrations.AddIndex(
            model_name='accountpayable',
            index=models.Index(fields=['due_date'], name='accounts_pa_due_dat_f30060_idx'),
        ),
        migrations.AddIndex(
            model_name='auditlog',
            index=models.Index(fields=['user'], name='audit_logs_user_id_73c422_idx'),
        ),
        migrations.AddIndex(
            model_name='auditlog',
            index=models.Index(fields=['action'], name='audit_logs_action_31f574_idx'),
        ),
        migrations.AddIndex(
            model_name='auditlog',
            index=models.Index(fields=['module'], name='audit_logs_module_f52b4d_idx'),
        ),
        migrations.AddIndex(
            model_name='auditlog',
            index=models.Index(fields=['target_id'], name='audit_logs_target__483e25_idx'),
        ),
        migrations.AddIndex(
            model_name='auditlog',
            index=models.Index(fields=['created_at'], name='audit_logs_created_262184_idx'),
        ),
        migrations.AddIndex(
            model_name='auditlog',
            index=models.Index(fields=['username'], name='audit_logs_usernam_eda0e7_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='supplierperformance',
            unique_together={('supplier', 'period_start', 'period_end')},
        ),
    ]
